protected function createImageResource($file, $type)
{
    switch ($type) {
        case 'image/jpeg':
            return imagecreatefromjpeg($file);
        case 'image/png';
            return imagecreatefrompng($file);
        case 'image/gif':
            return imagecreatefromgif($file);
        case 'image/webp':
            return imagecreatefromwebp($file);
    }
}

protected function addWatermark(array $image, $resource)
{
    // Calculate position of top-left corner in relation to main image
    $x = $image['w'] - $this->markW - $this->marginR;
    $y = $image['h'] - $this->markH - $this->marginB;
    // Merge the watermark resource into the main image resource
    imagecopy($resource, $this->watermark, $x, $y, 0, 0, $this->markW, $this->markH);
}