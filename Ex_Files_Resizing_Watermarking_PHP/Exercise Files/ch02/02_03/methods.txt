protected function getWebpDetails($image)
{
    $details = [];
    $resource = imagecreatefromwebp($image);
    $details['file'] = $image;
    $details['w'] = imagesx($resource);
    $details['h'] = imagesy($resource);
    $details['type'] = 'image/webp';
    imagedestroy($resource);
    return $details;
}

protected function checkJpegOrientation($image, $size)
{
    $outputFile = $image;
    $exif = exif_read_data($image);
    // Calculate required angle of rotation
    if (!empty($exif['Orientation'])) {
        switch ($exif['Orientation']) {
            case 3:
                $angle = 180;
                break;
            case 6:
                $angle = -90;
                break;
            case 8:
                $angle = 90;
                break;
            default:
                $angle = null;
        }
        // If necessary, rotate the image
        if (!is_null($angle)) {
            $original = imagecreatefromjpeg($image);
            $rotated = imagerotate($original, $angle, 0);
            // Save the rotated file with a new name
            $extension = pathinfo($image, PATHINFO_EXTENSION);
            $outputFile = str_replace(".$extension", '_rotated.jpg', $image);
            imagejpeg($rotated, $outputFile, 100);
            // Get the dimensions and MIME type of the rotated file
            $size = getimagesize($outputFile);
            imagedestroy($original);
            imagedestroy($rotated);
        }
    }
    return ['file' => $outputFile, 'size' => $size];
}
